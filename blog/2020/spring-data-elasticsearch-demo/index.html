<!DOCTYPE html>
<html>
    <head>
  <script type="text/javascript">
        function setVoice() {
            var vid = document.getElementById("voice");
            if(vid!=null){
            	vid.volume = 0.2;
            }
        }
        window.onload = setVoice;
        </script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
	  (adsbygoogle = window.adsbygoogle || []).push({
		google_ad_client: "ca-pub-0980023289791742",
		enable_page_level_ads: true
	  });
	</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Spring Data Elastichsearch İle Spring Boot ve Elastichsearch'ün Birlikte Kullanımı</title>
    <meta name="description" content="Merhabalar. Bu yazıda Spring Data Elasticsearch ile Spring Boot ve Elasticsearch’ün birlikte kullanımını anlatacağım. Bu yazıdaki kodları içeren örnek projey...">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://ilkaygunel.com/blog/2020/spring-data-elasticsearch-demo/">
    <link rel="alternate" type="application/rss+xml" title="İlkay Günel - Blog" href="http://ilkaygunel.com/feed.xml" />
      <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Spring Data Elastichsearch İle Spring Boot ve Elastichsearch’ün Birlikte Kullanımı | İlkay Günel - Blog</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Spring Data Elastichsearch İle Spring Boot ve Elastichsearch’ün Birlikte Kullanımı" />
<meta name="author" content="İlkay Günel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Spring Data Elastichsearch İle Spring Boot ve Elastichsearch’ün Birlikte Kullanımı" />
<meta property="og:description" content="Spring Data Elastichsearch İle Spring Boot ve Elastichsearch’ün Birlikte Kullanımı" />
<link rel="canonical" href="http://ilkaygunel.com/blog/2020/spring-data-elasticsearch-demo/" />
<meta property="og:url" content="http://ilkaygunel.com/blog/2020/spring-data-elasticsearch-demo/" />
<meta property="og:site_name" content="İlkay Günel - Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-09T19:40:21+03:00" />
<script type="application/ld+json">
{"dateModified":"2020-07-09T19:40:21+03:00","datePublished":"2020-07-09T19:40:21+03:00","url":"http://ilkaygunel.com/blog/2020/spring-data-elasticsearch-demo/","mainEntityOfPage":{"@type":"WebPage","@id":"http://ilkaygunel.com/blog/2020/spring-data-elasticsearch-demo/"},"author":{"@type":"Person","name":"İlkay Günel"},"description":"Spring Data Elastichsearch İle Spring Boot ve Elastichsearch’ün Birlikte Kullanımı","@type":"BlogPosting","headline":"Spring Data Elastichsearch İle Spring Boot ve Elastichsearch’ün Birlikte Kullanımı","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76541903-2', 'auto');
  ga('send', 'pageview');
</script>

    <main>
      <header class="site-header">
  <div class="container">
    <h1><a href="/">Ana Sayfa</a></h1>

    <button type="button" class="sliding-panel-button">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <nav class="navbar sliding-panel-content">
      <ul>
        
          <li><a href="/ilkay-gunel-cv.pdf" title="Bana Ait CV">Bana Ait CV</a></li>
        
          <li><a href="/blog/2016/git-nedir" title="Git Nedir? Nasıl Kullanılır?">Git Nedir? Nasıl Kullanılır?</a></li>
        
          <li><a href="/blog/2017/angular-2-tutorials" title="Angular 2">Angular 2</a></li>
        
          <li><a href="/blog/2016/maven-tutorials" title="Maven">Maven</a></li>
        
          <li><a href="/blog/2016/jsf-tutorials-list" title="JSF">JSF</a></li>
        
          <li><a href="/blog/2016/spring-tutorials" title="Spring 4">Spring 4</a></li>
        
          <li><a href="/blog/2016/eclipselink" title="Eclipselink">Eclipselink</a></li>
        
          <li><a href="/blog/2016/resteasy/" title="Resteasy">Resteasy</a></li>
        
          <li><a href="/blog/2016/mongodb/" title="MongoDB&Java">MongoDB&Java</a></li>
        
          <li><a href="/blog/2016/test" title="Test">Test</a></li>
        
          <li><a href="/blog/2016/useful-libraries-for-java" title="Java İçin Faydalı Kütüphaneler">Java İçin Faydalı Kütüphaneler</a></li>
        
          <li><a href="/about" title="Hakkımda">Hakkımda</a></li>
        
          <li><a href="/blog/2016/eclipse-notes" title="Eclipse">Eclipse</a></li>
        
          <li><a href="/blog/2016/formula1/" title="Formula 1">Formula 1</a></li>
        
          <li><a href="/blog/2016/kitaplar" title="Kitaplar">Kitaplar</a></li>
        
          <li><a href="/blog" title="Blog">Blog</a></li>
        
        <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i></a></li>
        <li><a href="https://1000kitap.com/ilkaygunel">1000Kitap</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="sliding-panel-fade-screen"></div>


      <div class="container">
        <article role="article" class="post">

  <div class="card">
    <header class="post-header">
      <h1 class="post-title">Spring Data Elastichsearch İle Spring Boot ve Elastichsearch'ün Birlikte Kullanımı</h1>
      <p class="post-meta">Jul 9, 2020</p>
    </header>

    <div class="post-content">
      <p>Merhabalar. Bu yazıda <strong><em>Spring Data Elasticsearch</em></strong> ile Spring Boot ve Elasticsearch’ün birlikte kullanımını anlatacağım. Bu yazıdaki kodları içeren örnek projeye https://github.com/ilkgunel/SpringDataElasticsearchDemo adresinden erişebilirsiniz. Şimdi başlayalım.</p>

<p><strong>Elasticsearch Nedir?</strong></p>

<p>Kaba taslak Elasticsearch’den bahsedecek olursak MongoDB gibi, Cassandra gibi Elasticsearch de bir açık kaynak kodlu NoSQL veritabanıdır. Elastichsearch’ü diğerlerinden ayıran nokta altyapısında arama motorlarının da alt yapısını barındıran Apache Lucene adındaki bir projenin olmasıdır. Bu proje sayesinde Elastichsearch indexleme ve arama işlemlerinde çok daha hızlı ve efektif iş yapmayı sağlamaktadır.</p>

<p>Elasticsearch’e her bir kayıt girişinde bu kayıt içerisinde yer alan alanlar Elastichsearch tarafından indexlenir. Bu sayede elasticsearch aranmak üzere gönderilen text’i veri kümeleri içinde aramak yerine index içinde arar, geçtiği yerleri hızlıca bulur ve döner.</p>

<p>Elasticsearch içerisindeki index kavramını klasik RDMS’teki veritabanına karşılık geliyor şeklinde düşünebiliriz.</p>

<p>Bu index kavramının altında <strong><em>type</em></strong> isminde bir kavram vardır, bu RDMS’teki tabloya karşılık geliyor diye düşünebiliriz.</p>

<p>type dediğimiz kavramın altında <strong><em>document</em></strong> adında bir kavram vardır. Bu kavram da RDMS’teki satırlara yani kayıtlara karşılık gelmektedir. Elasticsearch içerisindeki her bir doküman JSON formantında saklanmaktadır. Her bir document içerisinde bir ya da birden fazla document’e sahip olabilir.</p>

<p>Document kavramı da içerisinde <strong><em>field</em></strong> adındaki kavrama sahiptir. Bu kavram da RDMS’teki kolonlara karşılık geliyor diye düşünebiliriz.</p>

<p><strong>Demo Uygulama</strong></p>

<p>Şimdi Java dilinde Spring Boot tabanlı olacak şekilde bir demo uygulama yapalım.</p>

<p>Benim bilgisayarımda kurulu Elasticsearch içerisinde bir adet <strong><em>f1index</em></strong> aında index var. f1index altında da şu şekilde 1 tane kayıt tutuluyor.</p>

<p><a href="/images/springDataElasticsearch/1.png">
    <img src="/images/springDataElasticsearch/1.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Bizim örneğimiz de bu f1index’teki kayıtları okuma ve f1index üzerinde yazma, silme ve güncelleme işlemi yapacak.</p>

<p>Şimdi kaynak kodları inceleyelim.</p>

<p><strong>Driver.java</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ilkaygunel.model</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.data.annotation.Id</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.elasticsearch.annotations.Document</span><span class="o">;</span>

<span class="nd">@Document</span><span class="o">(</span><span class="n">indexName</span> <span class="o">=</span> <span class="s">"f1index"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Driver</span> <span class="o">{</span>

	<span class="nd">@Id</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>

	<span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

	<span class="kd">private</span> <span class="nc">String</span> <span class="n">surname</span><span class="o">;</span>

	<span class="kd">private</span> <span class="nc">String</span> <span class="n">team</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">get_id</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">set_id</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">getSurname</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">surname</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSurname</span><span class="o">(</span><span class="nc">String</span> <span class="n">surname</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">surname</span> <span class="o">=</span> <span class="n">surname</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">getTeam</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">team</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTeam</span><span class="o">(</span><span class="nc">String</span> <span class="n">team</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">team</span> <span class="o">=</span> <span class="n">team</span><span class="o">;</span>
	<span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>Az önce Elasticsearch’deki her bir kaydın birer Document olduğundan bahsetmiştik. Driver sınıfımız da her bir Document için temsil edici sınıfımız olacaktır.</p>

<ul>
  <li>Sınıfımızı @Document notasyonu ile işaretliyoruz ve notasyona parametre olarak kullanacağınız indexi <strong><em>indexName</em></strong> parametresi ile veriyoruz.</li>
  <li>Elastichsearch her bir kayıt için bir id üretir. Biz de üretilen id’yi kendi tarafımıza alabilmek için id isimli alanımızı @Id notasyonu ile işaretliyoruz.</li>
  <li>name, surname ve team alanlarını temsil eden değişkenlerimizi ve onlara ait get-set metotlarını da tanımlıyoruz.</li>
</ul>

<p><strong>DriverRepository.java</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ilkaygunel.repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.data.elasticsearch.repository.ElasticsearchRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.ilkaygunel.model.Driver</span><span class="o">;</span>

<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DriverRepository</span> <span class="kd">extends</span> <span class="nc">ElasticsearchRepository</span><span class="o">&lt;</span><span class="nc">Driver</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>

<span class="o">}</span></code></pre></figure>

<p>DriverRepository interface’imiz bizim için veri tabanı operasyonlarını gerçeklştirecek olan yapıdır.</p>

<ul>
  <li>@Repository sınıfı ile interface’i işaretleyip Spring’e kaydını yaptırıyoruz.</li>
  <li>interface’i <strong><em>ElasticsearchRepository</em></strong> interface’inden kalıtıyoruz. ElasticsearchRepository interface’ine parametre olarak Document’leri temsil eden sınıfı ve bu sınıftaki id’nin tipini geçiriyoruz.</li>
</ul>

<p><strong>DriverService.java</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ilkaygunel.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.ilkaygunel.model.Driver</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.ilkaygunel.repository.DriverRepository</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DriverService</span> <span class="o">{</span>

	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="nc">DriverRepository</span> <span class="n">driverRepository</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Driver</span><span class="o">&gt;</span> <span class="nf">allDrivers</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Driver</span><span class="o">&gt;</span> <span class="n">allDrivers</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Driver</span><span class="o">&gt;();</span>

		<span class="n">driverRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">driver</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="n">allDrivers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">driver</span><span class="o">);</span>
		<span class="o">});</span>

		<span class="k">return</span> <span class="n">allDrivers</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">saveDriver</span><span class="o">(</span><span class="nc">Driver</span> <span class="n">driver</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">driverRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">driver</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateDriver</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Driver</span> <span class="n">driverForUpdate</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">driverRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">key</span><span class="o">).</span><span class="na">ifPresentOrElse</span><span class="o">(</span><span class="n">driver</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="n">driver</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">driverForUpdate</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
			<span class="n">driver</span><span class="o">.</span><span class="na">setSurname</span><span class="o">(</span><span class="n">driverForUpdate</span><span class="o">.</span><span class="na">getSurname</span><span class="o">());</span>
			<span class="n">driver</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">driverForUpdate</span><span class="o">.</span><span class="na">getTeam</span><span class="o">());</span>
			<span class="n">driverRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">driver</span><span class="o">);</span>
		<span class="o">},</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"No Record With This Id!"</span><span class="o">);</span>
		<span class="o">});</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteDriver</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">driverRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">key</span><span class="o">).</span><span class="na">ifPresentOrElse</span><span class="o">(</span><span class="n">driver</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="n">driverRepository</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">driver</span><span class="o">);</span>
		<span class="o">},</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"No Record With This Id!"</span><span class="o">);</span>
		<span class="o">});</span>
	<span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>DriverService sınıfı bizim servis işlerimizi yapacak sınıftır.</p>

<ul>
  <li>Sınıfı @Service notasyonu ile işaretleyip kaydını yaptırıyoruz.</li>
  <li>@Autowired notasyonu DriverRepository’i inject ediyoruz.</li>
  <li>allDrivers metodu bize tüm sürücüleri dönecek.</li>
  <li>saveDriver metodu yeni sürücü kaydı yapacak.</li>
  <li>updateDriver metodu sürücü güncelleme işlemi yapacak.</li>
  <li>deleteDriver metodu sürücü silme işlemi yapacak.</li>
</ul>

<p><strong>RestEndPoints.java</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ilkaygunel.rest</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PathVariable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestBody</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.ilkaygunel.model.Driver</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.ilkaygunel.service.DriverService</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/api"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RestEndPoints</span> <span class="o">{</span>

	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="nc">DriverService</span> <span class="n">driverService</span><span class="o">;</span>

	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"/drivers"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Driver</span><span class="o">&gt;&gt;</span> <span class="nf">allDrivers</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Driver</span><span class="o">&gt;</span> <span class="n">allDrivers</span> <span class="o">=</span> <span class="n">driverService</span><span class="o">.</span><span class="na">allDrivers</span><span class="o">();</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Driver</span><span class="o">&gt;&gt;(</span><span class="n">allDrivers</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"/drivers"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">postDriver</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">Driver</span> <span class="n">driver</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">driverService</span><span class="o">.</span><span class="na">saveDriver</span><span class="o">(</span><span class="n">driver</span><span class="o">);</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span><span class="s">"Kayıt İşlemi Başarılı"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">PUT</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"/drivers/{id}"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">putDriver</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nd">@RequestBody</span> <span class="nc">Driver</span> <span class="n">driverForUpdate</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">driverService</span><span class="o">.</span><span class="na">updateDriver</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">driverForUpdate</span><span class="o">);</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span><span class="s">"Güncelleme İşlemi Başarılı"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">DELETE</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"/drivers/{id}"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">deleteDriver</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">driverService</span><span class="o">.</span><span class="na">deleteDriver</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span><span class="s">"Sime İşlemi Başarılı"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>RestEndPoints sınıfımız Rest API çağırımları için kullanılacak endpointleri barındırıyor. GET, POST, PUT ve DELETE HTTP metotları ile gelen istekleri servis kısmına iletecek endpointlerimiz yer alıyor. Bu kısımları daha önce başka yazılarda anlattığım için geçiyorum fakat sorularınız olursa yorum kısmına yazınız lütfen.</p>

<p><strong>RestClientConfig.java</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ilkaygunel.elastichsearchconfiguration</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.elasticsearch.client.RestHighLevelClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.elasticsearch.client.ClientConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.elasticsearch.client.RestClients</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.elasticsearch.config.AbstractElasticsearchConfiguration</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RestClientConfig</span> <span class="kd">extends</span> <span class="nc">AbstractElasticsearchConfiguration</span> <span class="o">{</span>

	<span class="nd">@Override</span>
	<span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">RestHighLevelClient</span> <span class="nf">elasticsearchClient</span><span class="o">()</span> <span class="o">{</span>
		<span class="kd">final</span> <span class="nc">ClientConfiguration</span> <span class="n">clientConfiguration</span> <span class="o">=</span> <span class="nc">ClientConfiguration</span><span class="o">.</span><span class="na">builder</span><span class="o">().</span><span class="na">connectedTo</span><span class="o">(</span><span class="s">"localhost:9200"</span><span class="o">)</span>
				<span class="o">.</span><span class="na">build</span><span class="o">();</span>

		<span class="k">return</span> <span class="nc">RestClients</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">clientConfiguration</span><span class="o">).</span><span class="na">rest</span><span class="o">();</span>
	<span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>RestClientConfig sınıfımız Elastichsearch ile iletişime geçecek client’in kayda geçirildiği sınıftır.</p>

<ul>
  <li>Sınıfımızı @Configuration notasyonu ile işaretleyip Spring’e tanıtıyoruz.</li>
  <li>Sınıfımızı AbstractElasticsearchConfiguration sınıfından kalıtıyoruz.</li>
  <li>AbstractElasticsearchConfiguration sınıfından gelen <strong><em>elasticsearchClient</em></strong> metodunu Override ediyoruz ve aynı zamanda <strong><em>RestHighLevelClient</em></strong> tipindeki bir objenin Spring tarafından kullanılabilmesi için @Bean notasyonu ile işaretliyoruz.</li>
  <li>elasticsearchClient metodu içerisinde Elasticsearch’ün çalıştığı host ve port bilgisini <strong><em>connectedTo</em></strong> metoduna vererek ClientConfiguration tipinde bir obje elde ediyoruz.</li>
  <li>Son olarak da RestClients sınıfındaki <strong><em>create</em></strong> metodunu ClientConfiguration tipindeki objeyi parametre vererek ve rest() metodunu çağırarak client objemizi elde etmiş oluyoruz.</li>
</ul>

<p><strong>Application.java</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ilkaygunel.application</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.ComponentScan</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.elasticsearch.repository.config.EnableElasticsearchRepositories</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="nd">@ComponentScan</span><span class="o">(</span><span class="s">"com.ilkaygunel.*"</span><span class="o">)</span>
<span class="nd">@EnableElasticsearchRepositories</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="s">"com.ilkaygunel.repository"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Application sınıfımız uygulamamızı ayağa kaldıracağımız sınıfımızdır.</p>

<ul>
  <li>Sınıfımızı @SpringBootApplication notasyonu ile işaretliyoruz.</li>
  <li>@ComponentScan(“com.ilkaygunel.*”) notasyonu ile com.ilkaygunel ve alt paketlerinin Spring tarafından taranmasını söylüyoruz.</li>
  <li>@EnableElasticsearchRepositories notasyonu ile de Elasticsearch için yazılmış repository’nin yer aldığı paketi kayda geçiyoruz. Bu paket altındaki repository’ler Spring tarafından içi doldurularak kullanıma hazır hale getirilecek.</li>
</ul>

<p><strong>DEMO</strong></p>

<p>Şimdi ilk olarak http://localhost:8080/api/drivers/ adresine GET isteği gönderiyorum ve aşağıdaki gibi bir sonuç alıyorum. f1index’teki kayıtlı document’i bize dönüyor.</p>

<p><a href="/images/springDataElasticsearch/2.png">
    <img src="/images/springDataElasticsearch/2.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Şimdi de http://localhost:8080/api/drivers/ adresine ekran görüntüsündeki body ile birlikte POST isteği gönderiyorum. Sonuç olarak bana kayıt işleminin başarılı olduğuna dair mesaj dönüyor. http://localhost:8080/api/drivers/ adresine tekrar GET isteği gönderdiğimde az önce eklediğim kayıt da dönen liste içerisinde yer alıyor.</p>

<p><a href="/images/springDataElasticsearch/3.png">
    <img src="/images/springDataElasticsearch/3.png" style="width: 958px; height= 400px;" />
</a></p>

<p><a href="/images/springDataElasticsearch/4.png">
    <img src="/images/springDataElasticsearch/4.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Şimdi de üye güncelleme işlemine bakalım.</p>

<p>http://localhost:8080/api/drivers/ adresine bir id bilgisi ekleyerek HTTP PUT isteğinde bulunacağım. Burada Charles Leclerc kullanıcısının id bilgisi olan <strong><em>_-KjOXMBsY0W27BzERPb</em></strong> bilgisini kullanarak PUT isteğinde bulunacağım. Bu durumda http://localhost:8080/api/drivers/_-KjOXMBsY0W27BzERPb adresine bir PUT isteği göndereceğim. İsteği aşağıdaki gibi gönderiyorum ve bana üye güncelleme işleminin başarılı olduğuna dair bir mesaj dönüyor. http://localhost:8080/api/drivers/ adresine tekrar bir GET isteği gönderiyorum. Charles Leclerc’in takım bilgisinin güncellendiğini görüyorum.</p>

<p><a href="/images/springDataElasticsearch/5.png">
    <img src="/images/springDataElasticsearch/5.png" style="width: 958px; height= 400px;" />
</a></p>

<p><a href="/images/springDataElasticsearch/6.png">
    <img src="/images/springDataElasticsearch/6.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Şimdi son olarak da silme işlemine bakalım.</p>

<p>Yine http://localhost:8080/api/drivers/ adresine bir id bilgisi ekleyeceğim ve elde ettiğim URL ile HTTP DELETE methodu çağırımı yapacağım. Güncelleme işleminden farklı olarak bir body göndermeyeceğim, sistem id bilgisi ile eşleşen kaydı bulup silecek. Alex Albon kullanıcısının id bilgisi olan BOLMOXMBsY0W27Bz7xSa bilgisini kullanarak  http://localhost:8080/api/drivers/BOLMOXMBsY0W27Bz7xSa adresini elde ediyorum ve aşağıdaki şekilde istekte bulunuyorum. Bana <strong><em>Silme İşlemi Başarılı</em></strong> şeklinde mesaj dönüyor. Yeniden http://localhost:8080/api/drivers/ adresine GET isteğinde bulunduğumda kaydın silinmiş olduğunu görüyorum.</p>

<p><a href="/images/springDataElasticsearch/7.png">
    <img src="/images/springDataElasticsearch/7.png" style="width: 958px; height= 400px;" />
</a></p>

<p><a href="/images/springDataElasticsearch/8.png">
    <img src="/images/springDataElasticsearch/8.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Bu yazıda anlatacaklarım da bu kadar arkadaşlar. Başka bir yazıda görüşmek üzere hoşçakalın.</p>

    </div>

    
<hr>

<aside id="comments" class="disqus">
  <div class="container">
    <h3><i class="icon icon-comments-o"></i> Comments</h3>
    <div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
/*
var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//ilkaygunel-com.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>                                    
  </div>
</aside>

  </div>

</article>

      </div>

      <footer class="site-footer">
  <div class="container">
    <ul class="social">
  <li><a href="https://www.instagram.com/ilkay_gunel/" target="_blank"><img src="/images/instagram.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="https://www.facebook.com/ilkay.gunel" target="_blank"><img src="/images/facebook.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="https://www.youtube.com/c/ilkaygunel" target="_blank"><img src="/images/youtube.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="http://twitter.com/ilkaygunel" target="_blank"><img src="/images/twitter.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="http://github.com/ilkgunel" target="_blank"><img src="/images/github.jpg" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="http://linkedin.com/in/ilkaygunel" target="_blank"><img src="/images/linkedin.png" style="width: 24px;height: 24px;"></img></a></li>
  
</ul>
    <p class="txt-medium-gray">
      <small>&copy;2020 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small>
    </p>
  </div>
</footer>


      <a href="http://github.com/ilkgunel/ilkgunel.github.io" target="_blank" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#337ab7; color:#fff; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

      <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
      <script>
      $(document).ready(function() {
        $('.sliding-panel-button,.sliding-panel-fade-screen,.sliding-panel-close').on('click touchstart',function (e) {
          $('.sliding-panel-content,.sliding-panel-fade-screen').toggleClass('is-visible');
          e.preventDefault();
        });
      });
      </script>
    </main>
  </body>
</html>
