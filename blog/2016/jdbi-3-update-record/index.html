<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>JDBI İle Database İşlemleri 3 - Kayıt Güncelleme</title>
    <meta name="description" content="Merhabalar.">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://ilkaygunel.com/blog/2016/jdbi-3-update-record/">
    <link rel="alternate" type="application/rss+xml" title="İlkay Günel - Blog" href="http://ilkaygunel.com/feed.xml" />
      <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>JDBI İle Database İşlemleri 3 - Kayıt Güncelleme - İlkay Günel - Blog</title>
<meta property="og:title" content="JDBI İle Database İşlemleri 3 - Kayıt Güncelleme" />
<meta name="description" content="JDBI İle Database İşlemleri 3 - Kayıt Güncelleme" />
<meta property="og:description" content="JDBI İle Database İşlemleri 3 - Kayıt Güncelleme" />
<link rel="canonical" href="http://ilkaygunel.com/blog/2016/jdbi-3-update-record/" />
<meta property="og:url" content="http://ilkaygunel.com/blog/2016/jdbi-3-update-record/" />
<meta property="og:site_name" content="İlkay Günel - Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-12-30T20:40:22+03:00" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "JDBI İle Database İşlemleri 3 - Kayıt Güncelleme",
    "datePublished": "2016-12-30T20:40:22+03:00",
    "description": "JDBI İle Database İşlemleri 3 - Kayıt Güncelleme",
    "url": "http://ilkaygunel.com/blog/2016/jdbi-3-update-record/"
  }
</script>
<!-- End Jekyll SEO tag -->
  </head>

  <body>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76541903-2', 'auto');
  ga('send', 'pageview');
</script>

    <main>
      <header class="site-header">
  <div class="container">
    <h1><a href="/">Ana Sayfa</a></h1>

    <button type="button" class="sliding-panel-button">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <nav class="navbar sliding-panel-content">
      <ul>
        
          <li><a href="/cv.pdf" title="Bana Ait CV">Bana Ait CV</a></li>
        
          <li><a href="/blog/2016/git-nedir" title="Git Nedir? Nasıl Kullanılır?">Git Nedir? Nasıl Kullanılır?</a></li>
        
          <li><a href="/blog/2016/jsf-tutorials-list" title="JSF">JSF</a></li>
        
          <li><a href="/blog/2016/spring-tutorials" title="Spring 4">Spring 4</a></li>
        
          <li><a href="/blog/2016/eclipselink" title="Eclipselink">Eclipselink</a></li>
        
          <li><a href="/blog/2016/resteasy/" title="Resteasy">Resteasy</a></li>
        
          <li><a href="/blog/2016/mongodb/" title="MongoDB&Java">MongoDB&Java</a></li>
        
          <li><a href="/blog/2016/test" title="Test">Test</a></li>
        
          <li><a href="/blog/2016/useful-libraries-for-java" title="Java İçin Faydalı Kütüphaneler">Java İçin Faydalı Kütüphaneler</a></li>
        
          <li><a href="/about" title="Hakkımda">Hakkımda</a></li>
        
          <li><a href="/blog/2016/eclipse-notes" title="Eclipse">Eclipse</a></li>
        
          <li><a href="/blog/2016/formula1/" title="Formula 1">Formula 1</a></li>
        
          <li><a href="/blog/2016/kitaplar" title="Kitaplar">Kitaplar</a></li>
        
          <li><a href="/blog" title="Blog">Blog</a></li>
        
        <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i></a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="sliding-panel-fade-screen"></div>


      <div class="container">
        <article role="article" class="post">

  <div class="card">
    <header class="post-header">
      <h1 class="post-title">JDBI İle Database İşlemleri 3 - Kayıt Güncelleme</h1>
      <p class="post-meta">Dec 30, 2016</p>
    </header>

    <div class="post-content">
      <p>Merhabalar.</p>

<p>Önceki yazıda JDBI Api ile nasıl çekeceğimizi görmüştük. Bu yazıda ise kayıt güncelleme konusuna değineceğiz.</p>

<p>Elimdeki People tablosunda şu şekilde 3 kayıt yer almakta:</p>

<p><a href="/images/jdbi/jdbi8.png">
<img src="/images/jdbi/jdbi8.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Ben şimdi buradaki id’si 2 olan kaydın <strong><em>city</em></strong> bilgisini İstanbul olarak güncellemek istiyorum. Bu işlem için öncelikle PersonOperationInterface içerisinde şu iki satır 
kodu yazıyorum:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@SqlUpdate</span><span class="o">(</span><span class="s">&quot;update people set city = :city where id= :id&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updatePerson</span><span class="o">(</span><span class="nd">@Bind</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">city</span><span class="o">,</span> <span class="nd">@Bind</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="kt">int</span> <span class="n">id</span><span class="o">);</span></code></pre></figure>

<p>Veritabanı üzerindeki bir manipülasyon yani değişiklik yapılacağı için metodu @SqlUpdate ile işaretledik. Notasyona parametre olarak da update işlemini gerçekleştirecek SQL cümleciğini
verdik. SQL komutunda alanı değiştirilecek city ve alan değişimi sırasında belirleyici olacak id alanlarını parametre olarak geçirdik. Metot içerisinde de önceki yazılardan hatırlayacağımız
gibi bu parametreleri @Bind notasyonu ile metodun parametre kısmında da tanımladık.</p>

<p>Tablo üzerinde güncelleme işlemini yapacak metodumuz da şu şekilde olacak:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ilkaygunel</span><span class="o">.</span><span class="na">jdbitutorial</span><span class="o">.</span><span class="na">operation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.mysql.cj.jdbc.MysqlDataSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.skife.jdbi.v2.DBI</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UpdateOneField</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MysqlDataSource</span> <span class="n">mysqlDataSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">MysqlDataSource</span><span class="o">();</span>
        <span class="n">mysqlDataSource</span><span class="o">.</span><span class="na">setURL</span><span class="o">(</span><span class="s">&quot;jdbc:mysql://localhost:3306/JDBIDatabase?useUnicode=true&amp;characterEncoding=UTF-8&quot;</span><span class="o">);</span>
        <span class="n">mysqlDataSource</span><span class="o">.</span><span class="na">setUser</span><span class="o">(</span><span class="s">&quot;root&quot;</span><span class="o">);</span>
        <span class="n">mysqlDataSource</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>

        <span class="n">DBI</span> <span class="n">dbi</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DBI</span><span class="o">(</span><span class="n">mysqlDataSource</span><span class="o">);</span>

        <span class="n">PersonOperationsInterface</span> <span class="n">personOperationsInterface</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">personOperationsInterface</span> <span class="o">=</span> <span class="n">dbi</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">PersonOperationsInterface</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
            <span class="n">personOperationsInterface</span><span class="o">.</span><span class="na">updatePerson</span><span class="o">(</span><span class="s">&quot;İstanbul&quot;</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;The Record Updated Successfully!&quot;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;An Error Occured!\n Error is:&quot;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">personOperationsInterface</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">personOperationsInterface</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>UpdateOneField sınıfımız tabloya bağlanmak için önceki yazılarımız ile hemen hemen aynı main metoduna sahip. Burada fazlalık olarak bir de veritabanı URL’nin sonunda 
<strong><em>?useUnicode=true&amp;characterEncoding=UTF-8</em></strong> komutunu ekledik. Daha önce de dediğim gibi JDBI JDBC katmanının üzerine kurulu. Java ile geliştirilen uygulamarda veri tabanını UTF-8
tanımlamak yeterli olmuyor ve veri tabanına bağlantı açılan URL’in Türkçe karakter ile çalışacağı söylenmesi gerekiyor. JDBC için de bağlantı URL’nin sonuna 
<strong><em>?useUnicode=true&amp;characterEncoding=UTF-8</em></strong> ifadesini eklediğimizde Türkçe karakter ile çalışabilir hale geliyor.</p>

<p>try bloğuiçerisinde JDBI vasıtası ile bir PersonOperationsInterface nesnesi elde ediyoruz ve bu nesne ile <strong><em>updatePerson()</em></strong> metodunu çağırıyoruz. Metoda güncellenecek şehir bilgisini
ve güncellenek kaydın id bilgisini geçirdik. Son olarak işlem update sırasında hata vermez ise işlemin başarılı gerçekleştiği mesajını yazdırıyoruz. Hata olursa da catch içinde yakalıyoruz.</p>

<p>finally içinde de kapatım işlemini yapıyoruz.</p>

<p>Kodu çalıştırdığımda konsol çıktısı şu şekilde olmakta:</p>

<p><a href="/images/jdbi/jdbi9.png">
<img src="/images/jdbi/jdbi9.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Veri tabanı üzerinden baktığımda da kaydın güncellenmiş olduğunu görüyorum:</p>

<p><a href="/images/jdbi/jdbi10.png">
<img src="/images/jdbi/jdbi10.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Birden fazla kayıt güncellemek istediğimiz durumu düşünelim şimdi. Örneğin name alanı Vedat olan tüm kayıtların city alanlarını Çanakkale olarak değiştirmek istiyorum.
Orada da yukarıdaki ile aynı işlem söz konusu olacak. Sadece parametre olarak id gibi tanımlayıcı bir alan yerine tekrarlanan alan olan name’i vereceğim.</p>

<p>Şu 2 satır kodu PersonOperationsInterface arabirimine ekliyorum:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@SqlUpdate</span><span class="o">(</span><span class="s">&quot;update people set city = :city where name= :name&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateMultiplePerson</span><span class="o">(</span><span class="nd">@Bind</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">city</span><span class="o">,</span> <span class="nd">@Bind</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">);</span></code></pre></figure>

<p>İşlemi yapacak kodum da şu şekilde:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ilkaygunel</span><span class="o">.</span><span class="na">jdbitutorial</span><span class="o">.</span><span class="na">operation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.mysql.cj.jdbc.MysqlDataSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.skife.jdbi.v2.DBI</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UpdateMultipleRecord</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MysqlDataSource</span> <span class="n">mysqlDataSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">MysqlDataSource</span><span class="o">();</span>
        <span class="n">mysqlDataSource</span><span class="o">.</span><span class="na">setURL</span><span class="o">(</span><span class="s">&quot;jdbc:mysql://localhost:3306/JDBIDatabase?useUnicode=true&amp;characterEncoding=UTF-8&quot;</span><span class="o">);</span>
        <span class="n">mysqlDataSource</span><span class="o">.</span><span class="na">setUser</span><span class="o">(</span><span class="s">&quot;root&quot;</span><span class="o">);</span>
        <span class="n">mysqlDataSource</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>

        <span class="n">DBI</span> <span class="n">dbi</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DBI</span><span class="o">(</span><span class="n">mysqlDataSource</span><span class="o">);</span>

        <span class="n">PersonOperationsInterface</span> <span class="n">personOperationsInterface</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">personOperationsInterface</span> <span class="o">=</span> <span class="n">dbi</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">PersonOperationsInterface</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
            <span class="n">personOperationsInterface</span><span class="o">.</span><span class="na">updateMultiplePerson</span><span class="o">(</span><span class="s">&quot;Çanakkale&quot;</span><span class="o">,</span> <span class="s">&quot;Vedat&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;The Records Updated Successfully!&quot;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;An Error Occured!\n Error is:&quot;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">personOperationsInterface</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">personOperationsInterface</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Kodu çalıştırdığımda tablonun yeri hali şu şekilde oluyor:</p>

<p><a href="/images/jdbi/jdbi11.png">
<img src="/images/jdbi/jdbi11.png" style="width: 958px; height= 400px;" />
</a></p>

<p>Bu yazıda anlatacaklarım da bu kadar arkadaşlar. Gelecek yazıda kayıt silme konusuna değineceğiz.</p>

<p>Görüşene kadar sağlıcakla kalın.</p>

<p style="text-align: center">Selam ve Sevgilerimle</p>

    </div>

    
<hr>

<aside id="comments" class="disqus">
  <div class="container">
    <h3><i class="icon icon-comments-o"></i> Comments</h3>
    <div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
/*
var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//ilkaygunel-com.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>                                    
  </div>
</aside>

  </div>

</article>

      </div>

      <footer class="site-footer">
  <div class="container">
    <ul class="social">
  <li><a href="http://github.com/ilkgunel" target="_blank"><i class="icon icon-github"></i></a></li>
  <li><a href="http://twitter.com/ilkgunel" target="_blank"><i class="icon icon-twitter"></i></a></li>
  <li><a href="https://www.facebook.com/ilkay.gunel" target="_blank"><i class="icon icon-facebook"></i></a></li>
  <li><a href="http://linkedin.com/in/ilkaygunel" target="_blank"><i class="icon icon-linkedin"></i></a></li>
  <li><a href="https://www.instagram.com/first.month/" target="_blank"><img src="/images/instagram.png" style="width: 24px;height: 24px;"></img></a></li>
</ul>
    <p class="txt-medium-gray">
      <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small>
    </p>
  </div>
</footer>


      <a href="http://github.com/ilkgune/ilkgunel.github.io" target="_blank" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#337ab7; color:#fff; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

      <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
      <script>
      $(document).ready(function() {
        $('.sliding-panel-button,.sliding-panel-fade-screen,.sliding-panel-close').on('click touchstart',function (e) {
          $('.sliding-panel-content,.sliding-panel-fade-screen').toggleClass('is-visible');
          e.preventDefault();
        });
      });
      </script>
    </main>
  </body>
</html>
