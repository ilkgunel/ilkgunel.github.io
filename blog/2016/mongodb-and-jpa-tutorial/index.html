<!DOCTYPE html>
<html>
    <head>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
	  (adsbygoogle = window.adsbygoogle || []).push({
		google_ad_client: "ca-pub-0980023289791742",
		enable_page_level_ads: true
	  });
	</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>JPA,JSF Ve PrimeFaces'ın MongoDB İle Kullanımı</title>
    <meta name="description" content="Yukarıdaki MongoDB&amp;Java bölümünden de bildiğiniz üzere daha MongoDB’nin Java driver’ı ile temel işlemler yapmıştık ve bir de Servlet&amp;JSP kullanarak y...">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://ilkaygunel.com/blog/2016/mongodb-and-jpa-tutorial/">
    <link rel="alternate" type="application/rss+xml" title="İlkay Günel - Blog" href="http://ilkaygunel.com/feed.xml" />
      <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>JPA,JSF Ve PrimeFaces’ın MongoDB İle Kullanımı - İlkay Günel - Blog</title>
<meta property="og:title" content="JPA,JSF Ve PrimeFaces’ın MongoDB İle Kullanımı" />
<meta name="description" content="JPA,JSF Ve PrimeFaces’ın MongoDB İle Kullanımı" />
<meta property="og:description" content="JPA,JSF Ve PrimeFaces’ın MongoDB İle Kullanımı" />
<link rel="canonical" href="http://ilkaygunel.com/blog/2016/mongodb-and-jpa-tutorial/" />
<meta property="og:url" content="http://ilkaygunel.com/blog/2016/mongodb-and-jpa-tutorial/" />
<meta property="og:site_name" content="İlkay Günel - Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-09-24T19:38:20+03:00" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "JPA,JSF Ve PrimeFaces’ın MongoDB İle Kullanımı",
    "datePublished": "2016-09-24T19:38:20+03:00",
    "description": "JPA,JSF Ve PrimeFaces’ın MongoDB İle Kullanımı",
    "url": "http://ilkaygunel.com/blog/2016/mongodb-and-jpa-tutorial/"
  }
</script>
<!-- End Jekyll SEO tag -->
  </head>

  <body>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76541903-2', 'auto');
  ga('send', 'pageview');
</script>

    <main>
      <header class="site-header">
  <div class="container">
    <h1><a href="/">Ana Sayfa</a></h1>

    <button type="button" class="sliding-panel-button">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <nav class="navbar sliding-panel-content">
      <ul>
        
          <li><a href="/ilkay-gunel-cv.pdf" title="Bana Ait CV">Bana Ait CV</a></li>
        
          <li><a href="/blog/2016/git-nedir" title="Git Nedir? Nasıl Kullanılır?">Git Nedir? Nasıl Kullanılır?</a></li>
        
          <li><a href="/blog/2017/angular-2-tutorials" title="Angular 2">Angular 2</a></li>
        
          <li><a href="/blog/2016/jsf-tutorials-list" title="JSF">JSF</a></li>
        
          <li><a href="/blog/2016/spring-tutorials" title="Spring 4">Spring 4</a></li>
        
          <li><a href="/blog/2016/eclipselink" title="Eclipselink">Eclipselink</a></li>
        
          <li><a href="/blog/2016/resteasy/" title="Resteasy">Resteasy</a></li>
        
          <li><a href="/blog/2016/mongodb/" title="MongoDB&Java">MongoDB&Java</a></li>
        
          <li><a href="/blog/2016/test" title="Test">Test</a></li>
        
          <li><a href="/blog/2016/useful-libraries-for-java" title="Java İçin Faydalı Kütüphaneler">Java İçin Faydalı Kütüphaneler</a></li>
        
          <li><a href="/about" title="Hakkımda">Hakkımda</a></li>
        
          <li><a href="/blog/2016/eclipse-notes" title="Eclipse">Eclipse</a></li>
        
          <li><a href="/blog/2016/formula1/" title="Formula 1">Formula 1</a></li>
        
          <li><a href="/blog/2016/kitaplar" title="Kitaplar">Kitaplar</a></li>
        
          <li><a href="/blog" title="Blog">Blog</a></li>
        
        <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i></a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="sliding-panel-fade-screen"></div>


      <div class="container">
        <article role="article" class="post">

  <div class="card">
    <header class="post-header">
      <h1 class="post-title">JPA,JSF Ve PrimeFaces'ın MongoDB İle Kullanımı</h1>
      <p class="post-meta">Sep 24, 2016</p>
    </header>

    <div class="post-content">
      <p>Yukarıdaki MongoDB&amp;Java bölümünden de bildiğiniz üzere daha MongoDB’nin Java driver’ı ile temel işlemler yapmıştık ve bir de Servlet&amp;JSP kullanarak yapılmış örnek projemiz vardı.
Fakat MongoDB Java çatısı altında sadece o şekilde kullanılmak zorunda değil. Sürekli yeni çıkan teknolojilere adapte olmaya çalışan ve onlara uygun yazılımlar çıkarmaya çalışan Java dünyası NoSQL dünyasına da kayıtsız kalmamış ve 
Java ile NoSQL kullanımını daha kolay hale getirmeye çalışmışlar.</p>

<p>Java dünyası içindeki ORM specificaton’ı olan JPA’nın resmi implementadyonu olan EclipseLink geliştiricileri NoSQL teknolojileri için kütüphane geliştirip bize sunmuşlar. Ben de bu yazıda bu EclipseLink’in NoSQL teknolojisini kullanarak bir kayıt ekleme örneğini yapacağım.
Kayıtları listeleme sayfasını da yazdım ancak ona yazı içerisinde değinmeyeceğim. <a href="https://github.com/ilkgunel/JsfJpaAndongoDBSampleProject">https://github.com/ilkgunel/JsfJpaAndongoDBSampleProject</a> adresinden o kısmı inceleyebilirsiniz. Ayrıca kayıt silme ve güncelleme işlemlerini de yazacağım.
Onları yazdığım zaman haberdar olmak için beni Twitter’dan takip edebilirsiniz: <a href="https://twitter.com/ilkgunel">https://twitter.com/ilkgunel</a></p>

<p>Başlayalım …</p>

<p>İlk olarak hangi bağımlılıklara ihtiyacımız var onları görelim.</p>

<p>Aşağıdaki listede 5 adet bağımlılığımız var. JSF’in 2.2.13 numaralı sürümü, PrimeFaces’ın 6 numaralı sürümü projemize ekli. org.eclipse.persistence altındaki JPA ve NoSQL’in 2.6.4 sürümünü ekledik. Bu kütüphaneler kayıt ekleme, çekme vs. işlemlerini basitize edecek.
Son olarak da MongoDB’nin Java driver’ını projemize ekledik. JPA ve NoSQL kütüphaneleri işlemlerini bu driver üzerinden yapacaklar. Burada önemli bir nokta mevcut. MongoDB’nin her ne kadar 3 ve üzerinde sürümleri olan Java driver’ı olsa da şu an için bu sürümler EclipseLink’in NoSQL teknolojisi ile uyumlu çalışamıyor.
Bu nedenle biz 2.13.0 sürümlü Java drvier’ı kullanıyoruz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.glassfish<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>javax.faces<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.2.13<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    
    <span class="nt">&lt;dependency&gt;</span>  
        <span class="nt">&lt;groupId&gt;</span>org.primefaces<span class="nt">&lt;/groupId&gt;</span>  
        <span class="nt">&lt;artifactId&gt;</span>primefaces<span class="nt">&lt;/artifactId&gt;</span>  
        <span class="nt">&lt;version&gt;</span>6.0<span class="nt">&lt;/version&gt;</span>  
    <span class="nt">&lt;/dependency&gt;</span> 
    
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.eclipse.persistence<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>org.eclipse.persistence.jpa<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.6.4<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.eclipse.persistence<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>org.eclipse.persistence.nosql<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.6.4<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.mongodb<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>mongo-java-driver<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.13.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;/dependencies&gt;</span>
</code></pre>
</div>

<p><strong>persistence.xml</strong></p>

<p>persistence.xml dosyamız içerisinde bağlantı kurulacak veritabanına ait bilgileri tanımlıyoruz. Burada veritabanına gönderilecek, alınacak vs. nesnelere ait sınıfların yani Entity sınıflarının <class></class> tagleri arasında belirtilmeleri gerekiyor. Aksi takdirde bilinmeyen tür gibisinden hatalar alabiliyoruz.
Property’lerin ilk ikisi MongoDB’ye bağlantı kurulması için gerekli sınıflara ait tanımlamalar. 3. property port, 4.property host, 5. property de bağlantı kurulacak veritabanının ismini belirtiyor.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;persistence</span> <span class="na">version=</span><span class="s">"2.0"</span> <span class="na">xmlns=</span><span class="s">"http://java.sun.com/xml/ns/persistence"</span> 
             <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> 
             <span class="na">xsi:schemaLocation=</span><span class="s">"http://java.sun.com/xml/ns/persistence</span> 
             <span class="err">http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;persistence-unit</span> <span class="na">name=</span><span class="s">"mongodbPersistenceUnit"</span> <span class="na">transaction-type=</span><span class="s">"RESOURCE_LOCAL"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;class&gt;</span>com.ilkaygunel.jpaandmongodb.entity.Person<span class="nt">&lt;/class&gt;</span>
    <span class="nt">&lt;properties&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"eclipselink.target-database"</span> 
                <span class="na">value=</span><span class="s">"org.eclipse.persistence.nosql.adapters.mongo.MongoPlatform"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"eclipselink.nosql.connection-spec"</span> 
                <span class="na">value=</span><span class="s">"org.eclipse.persistence.nosql.adapters.mongo.MongoConnectionSpec"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"eclipselink.nosql.property.mongo.port"</span> <span class="na">value=</span><span class="s">"27017"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"eclipselink.nosql.property.mongo.host"</span> <span class="na">value=</span><span class="s">"localhost"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"eclipselink.nosql.property.mongo.db"</span> <span class="na">value=</span><span class="s">"mongodatabase"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"eclipselink.logging.level"</span> <span class="na">value=</span><span class="s">"FINEST"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>
  <span class="nt">&lt;/persistence-unit&gt;</span>
<span class="nt">&lt;/persistence&gt;</span>
</code></pre>
</div>

<p><strong>index.xhtml’den Bir Parça</strong></p>

<p>Projemizin ana sayfasında şöyle bir kayıt formumuz var. Bu kayıt formu doldurulup butonuna tıkladığında MongoDB’ye ilgili bilgiler gönderiliyor.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="nt">&lt;h:form&gt;</span>
            <span class="nt">&lt;p:panelGrid</span> <span class="na">columns=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"İsim:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:inputText</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.person.name}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"Soyisim:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:inputText</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.person.surname}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"Telefon Numarası:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:inputMask</span> <span class="na">mask=</span><span class="s">"0(999) 999-99-99"</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.person.phoneNumber}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"Doğum Tarihi:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:calendar</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.person.birthDate}"</span> <span class="na">locale=</span><span class="s">"tr"</span> 
                            <span class="na">yearRange=</span><span class="s">"c-70:c+10"</span> <span class="na">navigator=</span><span class="s">"true"</span> <span class="na">mask=</span><span class="s">"true"</span> <span class="na">pattern=</span><span class="s">"dd-MM-yyyy"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"Adres Bilgileriniz"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:outputLabel/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"Cadde:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:inputText</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.address.street}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"Mahalle:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:inputText</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.address.neighborhood}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"İlçe:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:inputText</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.address.district}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"İl:"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:inputText</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.address.city}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel/&gt;</span>
                <span class="nt">&lt;p:commandButton</span> <span class="na">value=</span><span class="s">"GÖNDER"</span> <span class="na">ajax=</span><span class="s">"false"</span> 
                                                <span class="na">action=</span><span class="s">"#{managedBeanClass.saveDataToDatabase}"</span><span class="nt">/&gt;</span>

                <span class="nt">&lt;p:outputLabel</span> <span class="na">value=</span><span class="s">"#{managedBeanClass.operationMessage}"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:outputLabel/&gt;</span>
            <span class="nt">&lt;/p:panelGrid&gt;</span>
        <span class="nt">&lt;/h:form&gt;</span>
</code></pre>
</div>

<p>JSF sayfamız içinde kullanıcıdan birtakım bilgiler alınıyor ve managed bean içindeki <strong><em>saveDataToDatabase metodu</em></strong> ile MongoDB’ye gönderiliyor.</p>

<p><strong>ManagedBeanClass.java</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ilkaygunel</span><span class="o">.</span><span class="na">jpaandmongodb</span><span class="o">.</span><span class="na">bean</span><span class="o">;</span>
    
    <span class="kn">import</span> <span class="nn">com.ilkaygunel.jpaandmongodb.entity.Address</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">com.ilkaygunel.jpaandmongodb.entity.Person</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">java.text.ParseException</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.faces.bean.ManagedBean</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.faces.bean.SessionScoped</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.EntityManager</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.EntityManagerFactory</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Persistence</span><span class="o">;</span>
    
    <span class="nd">@ManagedBean</span>
    <span class="nd">@SessionScoped</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">ManagedBeanClass</span> <span class="o">{</span>
    
        <span class="kd">private</span> <span class="n">Person</span> <span class="n">person</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">Address</span> <span class="n">address</span><span class="o">;</span>
    
        <span class="kd">private</span> <span class="n">String</span> <span class="n">operationMessage</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    
        <span class="kd">public</span> <span class="n">ManagedBeanClass</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="o">();</span>
            <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">Person</span> <span class="n">getPerson</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">person</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setPerson</span><span class="o">(</span><span class="n">Person</span> <span class="n">person</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">person</span> <span class="o">=</span> <span class="n">person</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">Address</span> <span class="n">getAddress</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">address</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setAddress</span><span class="o">(</span><span class="n">Address</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getOperationMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">operationMessage</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setOperationMessage</span><span class="o">(</span><span class="n">String</span> <span class="n">operationMessage</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">operationMessage</span> <span class="o">=</span> <span class="n">operationMessage</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">saveDataToDatabase</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">ParseException</span> <span class="o">{</span>
            <span class="n">person</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>
    
            <span class="n">EntityManagerFactory</span> <span class="n">emf</span> <span class="o">=</span> <span class="n">Persistence</span><span class="o">.</span><span class="na">createEntityManagerFactory</span><span class="o">(</span><span class="s">"mongodbPersistenceUnit"</span><span class="o">);</span>
            <span class="n">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">().</span><span class="na">begin</span><span class="o">();</span>
                <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">person</span><span class="o">);</span>
                <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">().</span><span class="na">commit</span><span class="o">();</span>
                <span class="n">operationMessage</span> <span class="o">=</span> <span class="s">"Kayıt Başarı İle Eklendi!"</span><span class="o">;</span>
                <span class="n">GetRecordsBean</span> <span class="n">getRecordsBean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GetRecordsBean</span><span class="o">();</span>
                <span class="n">getRecordsBean</span><span class="o">.</span><span class="na">refreshPersonList</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">operationMessage</span> <span class="o">=</span> <span class="s">"Kayıt eklenirken bir hata meydana geldi! Hata:"</span><span class="o">+</span><span class="n">e</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">finally</span><span class="o">{</span>
                <span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                <span class="n">emf</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>           
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre>
</div>

<p>Managed bean içerisinde Person,Address ve operationMessage nesnelerimiz ve onlara ait get-set metotları yer alıyor. saveDataToDatabase metodu içerisinde tıpkı klasik veritabanlarında işlem yapar gibi <strong><em>EntityManager</em></strong> nesnesi elde edip bu nesnenin <strong><em>persist</em></strong> metodu ile veritabanına bilgi yolluyoruz.</p>

<p><strong>Person.java</strong></p>

<p>Person entity sınıfımız’da sınıfımızın işaretlendiği bir notasyona dikkat edelim. Entity sınıfımız @NoSql(dataFormat=DataFormatType.MAPPED) notasyonu ile işaretli. Bu notasyon ile JPA’ya ilişkisel olmayan bir veri kaynağı kullandığını söylüyoruz ve Java fieldlar ile MongoDB objeleri arasında mapleme yapmasını söylüyoruz.</p>

<p>Entity içerisinde Address alanına dikkat edersek bu alan Embedded notasyonu ile işaretlenmiş. Yani dökümanda bir alt alanımız olacak.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ilkaygunel</span><span class="o">.</span><span class="na">jpaandmongodb</span><span class="o">.</span><span class="na">entity</span><span class="o">;</span>
    
    <span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Basic</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Column</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.ElementCollection</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Embedded</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Entity</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.GeneratedValue</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Id</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Temporal</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.eclipse.persistence.nosql.annotations.DataFormatType</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.eclipse.persistence.nosql.annotations.Field</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.eclipse.persistence.nosql.annotations.NoSql</span><span class="o">;</span>
    
    <span class="nd">@Entity</span>
    <span class="nd">@NoSql</span><span class="o">(</span><span class="n">dataFormat</span><span class="o">=</span><span class="n">DataFormatType</span><span class="o">.</span><span class="na">MAPPED</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    
        <span class="kd">public</span> <span class="n">Person</span><span class="o">()</span> <span class="o">{</span> 
        <span class="o">}</span>
        
        <span class="nd">@Id</span>
        <span class="nd">@GeneratedValue</span>
        <span class="nd">@Field</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"_id"</span><span class="o">)</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
        
        <span class="nd">@Basic</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
        
        <span class="nd">@Basic</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">surname</span><span class="o">;</span>
        
        <span class="nd">@Basic</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">phoneNumber</span><span class="o">;</span>
        
        <span class="nd">@Basic</span>
        <span class="nd">@Temporal</span><span class="o">(</span><span class="n">javax</span><span class="o">.</span><span class="na">persistence</span><span class="o">.</span><span class="na">TemporalType</span><span class="o">.</span><span class="na">DATE</span><span class="o">)</span>
        <span class="kd">private</span> <span class="n">Date</span> <span class="n">birthDate</span><span class="o">;</span>
       
        <span class="nd">@Embedded</span>
        <span class="kd">private</span> <span class="n">Address</span> <span class="n">address</span><span class="o">;</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getId</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setId</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getName</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getSurname</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">surname</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setSurname</span><span class="o">(</span><span class="n">String</span> <span class="n">surname</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">surname</span> <span class="o">=</span> <span class="n">surname</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getPhoneNumber</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">phoneNumber</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setPhoneNumber</span><span class="o">(</span><span class="n">String</span> <span class="n">phoneNumber</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">phoneNumber</span> <span class="o">=</span> <span class="n">phoneNumber</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">Date</span> <span class="n">getBirthDate</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">birthDate</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setBirthDate</span><span class="o">(</span><span class="n">Date</span> <span class="n">birthDate</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">birthDate</span> <span class="o">=</span> <span class="n">birthDate</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">Address</span> <span class="n">getAddress</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">address</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setAddress</span><span class="o">(</span><span class="n">Address</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre>
</div>

<p><strong>Address.java</strong></p>

<p>Önceki MongoDB yazılarından hatırlayacağınız gibi MongoDB dökümanları içerisinde alt alanlar olabiliyordu. Yani bunlara embedded document deniliyordu. JPA içerisinde embedded dökümanaları tanımlamak için
@Embeddable notasyonu getirilmiş. Person.java içerisinde address alanı alt alandı ve onun tanımlandığı Address sınıfı @Embeddable notasyonu ile işaretli.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ilkaygunel</span><span class="o">.</span><span class="na">jpaandmongodb</span><span class="o">.</span><span class="na">entity</span><span class="o">;</span>
    
    <span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Basic</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.Embeddable</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.eclipse.persistence.nosql.annotations.DataFormatType</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">org.eclipse.persistence.nosql.annotations.NoSql</span><span class="o">;</span>
    
    <span class="nd">@Embeddable</span>
    <span class="nd">@NoSql</span><span class="o">(</span><span class="n">dataFormat</span><span class="o">=</span><span class="n">DataFormatType</span><span class="o">.</span><span class="na">MAPPED</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="kd">implements</span> <span class="n">Serializable</span><span class="o">{</span>
        <span class="nd">@Basic</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">street</span><span class="o">;</span>
        
        <span class="nd">@Basic</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">neighborhood</span><span class="o">;</span>
        
        <span class="nd">@Basic</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">district</span><span class="o">;</span>
        
        <span class="nd">@Basic</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">city</span><span class="o">;</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getStreet</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">street</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setStreet</span><span class="o">(</span><span class="n">String</span> <span class="n">street</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">street</span> <span class="o">=</span> <span class="n">street</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getNeighborhood</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">neighborhood</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setNeighborhood</span><span class="o">(</span><span class="n">String</span> <span class="n">neighborhood</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">neighborhood</span> <span class="o">=</span> <span class="n">neighborhood</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getDistrict</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">district</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setDistrict</span><span class="o">(</span><span class="n">String</span> <span class="n">district</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">district</span> <span class="o">=</span> <span class="n">district</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="n">String</span> <span class="n">getCity</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">city</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="kd">public</span> <span class="kt">void</span> <span class="n">setCity</span><span class="o">(</span><span class="n">String</span> <span class="n">city</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">city</span> <span class="o">=</span> <span class="n">city</span><span class="o">;</span>
        <span class="o">}</span>
        
        
    <span class="o">}</span>
</code></pre>
</div>

<p><strong>Ekran Çıktısı</strong></p>

<p>Ana sayfada gelen formu şu şekilde dolduruyorum ve GÖNDER butonuna tıklıyorum.</p>

<p><a href="/images/mongojpa/mongojpa1.png">
<img src="/images/mongojpa/mongojpa1.png" style="width: 958px; height= 400px;" /></a></p>

<p>Bana kaydın başarı ile yapıldığını söyleyen mesaj dönüyor.</p>

<p><a href="/images/mongojpa/mongojpa2.png">
<img src="/images/mongojpa/mongojpa2.png" style="width: 958px; height= 400px;" /></a></p>

<p>MongoDB’nin arayüz programı üzerinden baktığımda da kaydın başarı ile yollandığını görüyorum.</p>

<p><a href="/images/mongojpa/mongojpa3.png">
<img src="/images/mongojpa/mongojpa3.png" style="width: 958px; height= 400px;" /></a></p>

<p>Bu yazıda da bu kadar arkadaşlar. Yazının başında da söylediğim gibi github’daki projeyi güncelleme ve silme işlemleri için de geliştireceğim. Haberdar olmak için Twitter’dan takip etmeyi unutmayın.</p>

<p>Başka bir yazıda görüşene kadar sağlıcakla kalın.</p>

<p style="text-align: center">Selam ve Sevgilerimle</p>

    </div>

    
<hr>

<aside id="comments" class="disqus">
  <div class="container">
    <h3><i class="icon icon-comments-o"></i> Comments</h3>
    <div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
/*
var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//ilkaygunel-com.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>                                    
  </div>
</aside>

  </div>

</article>

      </div>
      <div id="sagdasabit" style="position: absolute; right: 0px; top: 0px; z-index: 1;">
        <a class="twitter-timeline" href="https://twitter.com/ilkaygunel">Tweets by ilkaygunel</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- test -->
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-0220861037824235"
            data-ad-slot="8085613483"
            data-ad-format="auto"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <footer class="site-footer">
  <div class="container">
    <ul class="social">
  <li><a href="https://www.instagram.com/ilkay_gunel/" target="_blank"><img src="/images/instagram.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="https://www.facebook.com/ilkay.gunel" target="_blank"><img src="/images/facebook.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="https://www.youtube.com/c/ilkaygunel" target="_blank"><img src="/images/youtube.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="http://twitter.com/ilkaygunel" target="_blank"><img src="/images/twitter.png" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="http://github.com/ilkgunel" target="_blank"><img src="/images/github.jpg" style="width: 24px;height: 24px;"></img></a></li>
  <li><a href="http://linkedin.com/in/ilkaygunel" target="_blank"><img src="/images/linkedin.png" style="width: 24px;height: 24px;"></img></a></li>
  
</ul>
    <p class="txt-medium-gray">
      <small>&copy;2017 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small>
    </p>
  </div>
</footer>


      <a href="http://github.com/ilkgune/ilkgunel.github.io" target="_blank" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#337ab7; color:#fff; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

      <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
      <script>
      $(document).ready(function() {
        $('.sliding-panel-button,.sliding-panel-fade-screen,.sliding-panel-close').on('click touchstart',function (e) {
          $('.sliding-panel-content,.sliding-panel-fade-screen').toggleClass('is-visible');
          e.preventDefault();
        });
      });
      </script>
    </main>
  </body>
</html>
